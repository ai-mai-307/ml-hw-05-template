# Формулировка задания

## Описания задания

Мы переходим к изучению обучения без учителя. Ваша задача -- применить несколько алгоритмов кластеризации и понижения размерности для анализа ранее рассмотренных вами датасетов: NYC Taxi и UK Car Accidents.

Вы должны найти оптимальный вариант кластеризации матрицы признаков, полученной с помощью разработанного вами ранее пайплайна предобработки данных. Далее вы должны сократить размерность полученного признакового представления до 2D и построить визуализации для сравнения результатов кластеризации и истинного распределения относительного выбранного заранее псевдо-таргета.


## Постановка задачи

1. **Выделить псевдо-таргет.**  
   Псевдо-таргет в этом задании — **категориальный столбец**, который **не используется при обучении кластеризации**, а применяется **только для внешней оценки** (homogeneity, completeness, V-measure) и для сравнения на визуализациях.

2. **Получить матрицы признаков** для обоих датасетов по пайплайнам из ПЗ №2.

3. Реализовать **собственноручно** и применить:  
   - k-means.  
   - Иерархическая агломерация
   - DBSCAN — разрешается готовая библиотечная реализация.


4. **Поиск оптимальной кластеризации**  
   Обязательно варьировать:  
   - для k-means: `k` и функции расстояния,  
   - для агломеративной кластеризации: глубина дерева (порог, `h`) и функция расстояния между кластерами (`linkage`),  
   - для DBSCAN: eps окрестность и `min_samples`

5. Вести **таблицу экспериментов.**  
   Вести единую таблицу, фиксируя для каждой конфигурации:  
   - датасет, алгоритм, метрика расстояния, гиперпараметры, random_state;  
   - **внутренние метрики:** среднее внутрикластерное расстояние, среднее межкластерное расстояние, silhouette;  
   - **внешние метрики по псевдо-таргету:** homogeneity, completeness, **V-measure**;  
   - время/кол-во итераций (необязательно, но полезно для сравнения).  

6. **Понижение размерности и 2D-визуализация.**  
   - Сделать понижение размерности **тремя способами**: **PCA (собственноручная реализация)**, t-SNE, UMAP.  
   - Построить 2D-визуализацию и сравнить:  
     1) раскраску по псевдо-таргету (ground truth),  
     2) раскраску по меткам кластеризации.  
   - Сопроводить кратким анализом наблюдаемых различий.

---

## Критерии оценивания

### Обязательные условия (без них работа не проверяется)
- Решение в `solution.ipynb`
- Аккуратный вид блокнота `solution.ipynb` 
- Сделаны собственноручные реализации k-means, иерархической кластеризации и PCA.  
- Есть ссылка на Google таблицу с описанием экспериментов
- Нет подозрений в незадекларированном использовании LLM

В случае невыполнения этих требований работа оценивается в 0 баллов. У команды есть одна попытка на исправление.

### Задачи

1. **Собственноручная реализация k-means**:
    - 2 балла: корректная реализация без существенных замечаний
    - 1 балл: есть замечания по реализации
    - 0 баллов: не реализована или использована готовая реализация 

2. **Собственноручная реализация иерархической кластеризации**:
    - 2 балла: корректная реализация без существенных замечаний
    - 1 балл: есть замечания по реализации
    - 0 баллов: не реализована или использована готовая реализация 

3. **Собственноручная реализация PCA**: 
    - 2 балла: корректная реализация без существенных замечаний
    - 1 балл: есть замечания по реализации
    - 0 баллов: не реализована или использована готовая реализация 

4. **Экперименты по кластеризации**:
    - 2 балла: не менее трех экспериментов на каждый алгоритм кластеризации, корректная таблица экспериментов, обоснованый выбор оптимального варианта кластеризации
    - 1 балл: таблица не полна, малое количество экспериментов, не хватает метрик, неудобный вид таблицы
    - 0 баллов: таблица отстутствует или крайне плохая

5. **Визуализация и интерпретация** — *2 балла*  
    - 2 балла: три пары красивых картинок "ground truth" VS. "лучшая кластеризация", по одной паре на каждый алгоритм сокращения размерностей
    - 1 балл: не хватает картинок, визуализации непригодны для визуального анализа
    - 1 балл: таблица не полна, малое количество экспериментов, не хватает метрик, неудобный вид таблицы
    - 0 баллов: нет картинок или они не смотрибельны

---

## Комментарий

### Выбор псевдо-таргета

**NYC Taxi (варианты):**  
- `payment_type` — рекомендовано;  
- `RatecodeID`, `VendorID`;  
- другой разумный вариант на ваш выбор

**UK Car Accidents (варианты):**  
- `Accident_Severity` (Fatal/ Not Fatal);  
- `Urban_or_Rural_Area`;  
- `Light_Conditions`, `Weather_Conditions`;  
- `Road_Type`/`Junction_Control`;  
- другой разумный вариант на ваш выбор

> Псевдо-таргет **не участвует** в обучении кластеризации. Используйте его **только** для внешней оценки и визуальной проверки.

**Колонки  таблицы экспериментов:**  
`dataset | algo | **params (несколько колонок) | intra_mean | inter_mean | silhouette | homogeneity | completeness | v_measure`